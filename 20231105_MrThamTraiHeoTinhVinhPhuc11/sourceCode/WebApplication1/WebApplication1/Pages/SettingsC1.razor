@page "/c1"

@using System.ComponentModel.DataAnnotations

<EditForm Model="@model" OnValidSubmit="OnValidSubmit" OnInvalidSubmit="OnInvalidSubmit">
    <DataAnnotationsValidator />

    <MudGrid Spacing="1" Class="m-2">
        <MudItem xs="12">
            <MudCard>
                <MudCardContent>
                    <MudGrid Spacing="1" Class="pt-2">
                       <MudItem xs="12">
                           <MudCard Class="m-2">
                               <MudCardHeader Class="bg-success h-4">Cài đặt giai đoạn</MudCardHeader>
                               <MudCardContent>
                                   <MudGrid Spacing="1">
                                       <MudItem xs="12">
                                           <MudSelect @bind-Value="enumValue" Label="CHỌN GIAI ĐOẠN" HelperText="Chọn giai đoạn để cài đặt các thông số" OpenIcon="@Icons.Material.Filled.LocalDrink" AdornmentColor="Color.Secondary" Variant="Variant.Outlined">
                                               @foreach (StepRun item in Enum.GetValues(typeof(StepRun)))
                                               {
                                                   <MudSelectItem Value="@item">@item</MudSelectItem>
                                               }
                                           </MudSelect>
                                       </MudItem>
                                       <MudItem xs="12">
                                           <MudGrid Spacing="1">
                                               <MudItem xs="12" sm="3">
                                                   <MudNumericField Label="Từ ngày" HelperText="Ngày bắt đầu giai đoạn" Class="m-2"
                                                                    @bind-Value="model.FromDate" For="@(()=>model.FromDate)"></MudNumericField>
                                               </MudItem>
                                               <MudItem xs="12" sm="3">
                                                   <MudNumericField Label="Đến ngày" HelperText="Ngày kết thúc giai đoạn" Class="m-2"
                                                                    @bind-Value="model.ToDate" For="@(()=>model.ToDate)"></MudNumericField>
                                               </MudItem>
                                               <MudItem xs="12" sm="3">
                                                   <MudNumericField Label="Số quạt chạy cố định" Class="m-2"
                                                                    @bind-Value="model.StaticFanRun" For="@(()=>model.StaticFanRun)"></MudNumericField>
                                               </MudItem>
                                               <MudItem xs="12" sm="3">
                                                   <MudNumericField Label="Nhiệt bật dàn mát (oC)" Class="m-2"
                                                                    @bind-Value="model.TempRunCooler" For="@(()=>model.LowFrequency)"></MudNumericField>
                                               </MudItem>
                                           </MudGrid>
                                       </MudItem>
                                       <MudItem xs="12">
                                           <MudGrid Spacing="1">
                                               <MudItem xs="12" sm="3">
                                                   <MudNumericField Label="Nhiệt độ cao (oC)" Class="m-2"
                                                                    @bind-Value="model.HightTemperature" For="@(()=>model.HightTemperature)"></MudNumericField>
                                               </MudItem>
                                               <MudItem xs="12" sm="3">
                                                   <MudNumericField Label="Nhiệt độ thấp (oC)" Class="m-2"
                                                                    @bind-Value="model.Lowtemperature" For="@(()=>model.Lowtemperature)"></MudNumericField>
                                               </MudItem>
                                               <MudItem xs="12" sm="3">
                                                   <MudNumericField Label="Tần số cao (Hz)" Class="m-2"
                                                                    @bind-Value="model.HightFrequency" For="@(()=>model.HightFrequency)"></MudNumericField>
                                               </MudItem>
                                               <MudItem xs="12" sm="3">
                                                   <MudNumericField Label="Tần số thấp (Hz)" Class="m-2"
                                                                    @bind-Value="model.LowFrequency" For="@(()=>model.LowFrequency)"></MudNumericField>
                                               </MudItem>
                                           </MudGrid>
                                       </MudItem>
                                       <MudItem xs="12">
                                           <MudGrid Spacing="1">
                                               <MudItem xs="12" sm="3">
                                                   <MudNumericField Label="Nhiệt độ bật quạt 1 (oC)" Class="m-2"
                                                                    @bind-Value="model.TempRunFan1" For="@(()=>model.TempRunFan1)"></MudNumericField>
                                               </MudItem>
                                               <MudItem xs="12" sm="3">
                                                   <MudNumericField Label="Nhiệt độ bật quạt 2 (oC)" Class="m-2"
                                                                    @bind-Value="model.TempRunFan2" For="@(()=>model.TempRunFan2)"></MudNumericField>
                                               </MudItem>
                                               <MudItem xs="12" sm="3">
                                                   <MudNumericField Label="Nhiệt độ bật quạt 3 (oC)" Class="m-2"
                                                                    @bind-Value="model.TempRunFan3" For="@(()=>model.TempRunFan3)"></MudNumericField>
                                               </MudItem>
                                               <MudItem xs="12" sm="3">
                                                   <MudNumericField Label="Nhiệt độ bật quạt 4 (oC)" Class="m-2"
                                                                    @bind-Value="model.TempRunFan4" For="@(()=>model.TempRunFan4)"></MudNumericField>
                                               </MudItem>
                                           </MudGrid>
                                       </MudItem>
                                   </MudGrid>

                               </MudCardContent>
                           </MudCard>
                       </MudItem>
                        <MudItem xs="12">
                           <MudCard Class="m-2">
                               <MudCardHeader Class="bg-success">Cài đặt chung</MudCardHeader>
                               <MudCardContent>
                                   <MudGrid Spacing="1" Class="m-2">
                                       <MudItem xs="12" sm="3">
                                           <MudNumericField Label="Thời gian chạy dàn mát (phút)" Class="m-2"
                                                            @bind-Value="model.TempRunFan1" For="@(()=>model.TempRunFan1)"></MudNumericField>
                                       </MudItem>
                                       <MudItem xs="12" sm="3">
                                           <MudNumericField Label="Thời gian nghỉ dàn mát (phút)" Class="m-2"
                                                            @bind-Value="model.TempRunFan2" For="@(()=>model.TempRunFan2)"></MudNumericField>
                                       </MudItem>
                                       <MudItem xs="12" sm="3">
                                           <MudNumericField Label="Quạt 1" Class="m-2"
                                                            @bind-Value="model.TempRunFan3" For="@(()=>model.TempRunFan3)"></MudNumericField>
                                       </MudItem>
                                       <MudItem xs="12" sm="3">
                                           <MudNumericField Label="Quat 2" Class="m-2"
                                                            @bind-Value="model.TempRunFan4" For="@(()=>model.TempRunFan4)"></MudNumericField>
                                       </MudItem>
                                       <MudItem xs="12" sm="3">
                                           <MudNumericField Label="Quat 3" Class="m-2"
                                                            @bind-Value="model.TempRunFan4" For="@(()=>model.TempRunFan4)"></MudNumericField>
                                       </MudItem>
                                       <MudItem xs="12" sm="3">
                                           <MudNumericField Label="Quat 4" Class="m-2"
                                                            @bind-Value="model.TempRunFan4" For="@(()=>model.TempRunFan4)"></MudNumericField>
                                       </MudItem>
                                   </MudGrid>
                               </MudCardContent>
                           </MudCard>
                        </MudItem>
                    </MudGrid>
                </MudCardContent>
                <MudCardActions>
                    <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary" Class="ml-auto">Cập nhật</MudButton>
                </MudCardActions>
            </MudCard>
        </MudItem>
        <MudItem xs="12">
            <MudPaper Class="pa-4 mud-height-full">
                <MudText Typo="Typo.subtitle2">Validation Summary</MudText>
                @if (success)
                {
                    <MudText Color="Color.Success">Success</MudText>
                }
                else
                {
                    <MudText Color="@Color.Error">
                        <ValidationSummary />
                    </MudText>
                }
            </MudPaper>
        </MudItem>
        <MudItem xs="12">
            <MudText Typo="Typo.body2" Align="Align.Center">
                Fill out the form correctly to see the success message.
            </MudText>
        </MudItem>
    </MudGrid>
</EditForm>


@code {
    RegisterAccountForm model = new RegisterAccountForm();
    bool success;

    public class RegisterAccountForm
    {
        //[Required]
        //[StringLength(8, ErrorMessage = "Name length can't be more than 8.")]
        //public string Username { get; set; }

        //[Required]
        //[EmailAddress]
        //public string Email { get; set; }

        //[Required]
        //[StringLength(30, ErrorMessage = "Password must be at least 8 characters long.", MinimumLength = 8)]
        //public string Password { get; set; }

        //[Required]
        //[Compare(nameof(Password))]
        //public string Password2 { get; set; }

        public int Id { get; set; }
        public int ChuongId { get; set; }//id cua chuồng

        public int StepRun { get; set; }//giai đoạn
        [Required]
        [Range(0, 100, ErrorMessage = "chỉ được nhập từ 0 đến 100")]
        public int FromDate { get; set; }
        [Required]
        [Range(0, 100, ErrorMessage = "chỉ được nhập từ 0 đến 100")]
        public int ToDate { get; set; }

        [Required]
        [RegularExpression(@"^[0-4]{1}$", ErrorMessage = "Chỉ được nhập số nguyên <= 4")]
        public int StaticFanRun { get; set; }

        [Required]
        public double HightTemperature { get; set; }
        [Required]
        public double Lowtemperature { get; set; }

        [Required]
        [RegularExpression(@"^[0-50]{1}$", ErrorMessage = "Chỉ nhập <= 50 Hz")]
        public double HightFrequency { get; set; }
        public double LowFrequency { get; set; }
        public double TempRunFan1 { get; set; }
        public double TempRunFan2 { get; set; }
        public double TempRunFan3 { get; set; }
        public double TempRunFan4 { get; set; }
        public double TempRunCooler { get; set; }
    }

    private void OnValidSubmit(EditContext context)
    {
        success = true;
        _snackBar.Add(model.FromDate.ToString(), Severity.Success);
        StateHasChanged();
    }

    private void OnInvalidSubmit(EditContext context)
    {
        success = false;
        _snackBar.Add($"Invalid data", Severity.Error);
        StateHasChanged();
    }

    private string stringValue { get; set; }
    private StepRun enumValue { get; set; } = StepRun.GiaiDoan1;
    public enum StepRun { GiaiDoan1, GiaiDoan2, GiaiDoan3, GiaiDoan4, GiaiDoan5, GiaiDoan6, GiaiDoan7, GiaiDoan8, GiaiDoan9, GiaiDoan10, }
}
